{% extends 'main.html' %}
{% block content %}

<div class="vertical-center">
<div>
    <img id="logo-image" src="/static/img/logo.png">
</div>
<div class="form-group">
    <form id="rsid_search_form" method="POST" action="/results/">
        <label class="control-label">Input rsid numbers as integers seperated by spaces</label>
        <div class="input-group">
            <span class="input-group-addon">RSID(s):</span>
            <input type="text" id="rsidInput" class="form-control" name="rsids" placeholder="e.g. 328 326 3">
            <span class="input-group-btn">
                <button class="btn btn-default" type="submit">Search</button>
            </span>
        </div>
        Base word weight on the following:
        <div class="checkbox">
          <label>
            <input type="checkbox" name="weight" value="word_count" checked> Word Count
          </label>
        </div>
        <div class="checkbox">
          <label>
            <input type="checkbox" name="weight" value="article_count"> Article Count
          </label>
        </div>
        <div class="checkbox">
          <label>
            <input type="checkbox" name="weight" value="rsid_count"> Associated RSID's
          </label>
        </div>
        <div class="checkbox">
            <label>
                <input type="checkbox" name="weight" value="rsid_balance"> Normalize results by number of articles associated with each RSID
            </label>
        </div>
    </form>
</div>
<div class="info_paragraph">
    {% filter markdown %}
        {{ home_markdown }}
    {% endfilter %}
</div>
</div>


<script>
    function predictiveResults(input, data) {
        var predictionArray = [];
        var inputSplit = input.split(" ")
        var inputNumber = inputSplit.slice(-1)[0].replace('rs', '');
        if (inputNumber == "") {
            return [];
        }
        for (var i = 0; i < data.length; i++) {
            if (predictionArray.length > 5) {
                break;
            }
            var rsid = data[i];
            if (rsid.startsWith(inputNumber)) {
                var suggestion = ""
                for (var j = 0; j < inputSplit.length; j++) {
                    if (j == inputSplit.length - 1) {
                        suggestion += inputSplit[j].replace(inputNumber, rsid)
                    }
                    else {
                        suggestion += inputSplit[j] + " "
                    }
                }
                predictionArray.push(suggestion);
            }
        }
        return predictionArray;
    };

    var rsidList
    $.getJSON('/static/data/rsid_list.json', function(data) {
        rsidList = data;
    });

    $('#rsidInput').autocomplete({
        source: function(request, response) {
            response(predictiveResults(request.term, rsidList));
        }
    });
</script>
{% endblock %}
